<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Megawheel Tracker PRO - 5000 Stats</title>
    <style>
        :root { --primary: #007bff; --success: #28a745; --warning: #ffc107; --danger: #dc3544; --dark: #343a40; }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #f4f7f6; padding: 10px; color: #333; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: var(--dark); margin-bottom: 20px; }
        
        .tabs { display: flex; justify-content: space-between; margin-bottom: 15px; background: #eee; padding: 5px; border-radius: 8px; }
        .tab-btn { flex: 1; padding: 10px; border: none; cursor: pointer; background: none; font-weight: bold; transition: 0.3; border-radius: 5px; font-size: 13px; }
        .tab-btn.active { background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); color: var(--primary); }

        select { width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 8px; border: 1px solid #ddd; font-size: 16px; }
        
        .grid-btns { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .btn { padding: 12px; border: none; border-radius: 8px; color: white; font-weight: bold; cursor: pointer; transition: all 0.2s; font-size: 13px; }
        .add { background: var(--success); }
        .pred { background: var(--primary); }
        .chart { background: var(--dark); }
        .reset { background: var(--danger); width: 100%; margin-top: 10px; }

        .box { background: #f9f9f9; padding: 15px; border-radius: 10px; margin-top: 15px; border-left: 5px solid var(--primary); }
        .res-scroll { display: flex; gap: 5px; overflow-x: auto; padding: 10px 0; flex-wrap: wrap; max-height: 200px; overflow-y: auto; }
        .res-item { background: #444; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; min-width: 25px; text-align: center; }
        
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
        .stat-card { background: white; padding: 10px; border-radius: 8px; border: 1px solid #eee; text-align: center; }
        .stat-val { display: block; font-size: 18px; font-weight: bold; color: var(--primary); }
        .info-text { font-size: 12px; color: #666; margin-top: 5px; text-align: center; }
    </style>
</head>
<body>

<div class="container">
    <h2>üéØ Megawheel Tracker PRO</h2>

    <select id="numero">
        <option value="">Choisir num√©ro tomb√©</option>
        <option value="1">1</option><option value="2">2</option><option value="5">5</option>
        <option value="8">8</option><option value="10">10</option><option value="15">15</option>
        <option value="20">20</option><option value="30">30</option><option value="40">40</option>
    </select>

    <div class="grid-btns">
        <button class="btn add" onclick="ajouter()">‚ûï Ajouter</button>
        <button class="btn pred" onclick="prediction()">üîç Pr√©diction</button>
        <button class="btn chart" onclick="simulationFull()">üìä Simu 5000</button>
    </div>

    <div class="tabs">
        <button id="t24" class="tab-btn active" onclick="switchTab(24)">Derniers 500 (24h)</button>
        <button id="t48" class="tab-btn" onclick="switchTab(48)">500-1000 (48h)</button>
        <button id="t72" class="tab-btn" onclick="switchTab(72)">1000-5000 (72h)</button>
    </div>

    <div class="box">
        <h3>Historique (<span id="count">0</span> / 5000)</h3>
        <div id="historique" class="res-scroll"></div>
        <div id="empty-msg" style="display:none; text-align:center; color:#999; padding:20px;">Aucune donn√©e dans cette tranche.</div>
    </div>

    <div class="box" style="border-left-color: var(--success);">
        <h3>ü§ñ Analyse sur 5000 r√©sultats</h3>
        <div id="prediction-res">
            Cliquez sur "Pr√©diction" pour analyser la base.
        </div>
    </div>

    <button class="btn reset" onclick="resetData()">üóë Effacer tout (Reset)</button>
    <p class="info-text">Les donn√©es sont sauvegard√©es localement dans votre navigateur.</p>
</div>

<script>
    let resultats = JSON.parse(localStorage.getItem("mw_pro_5000")) || [];
    let currentView = 24;

    function save() {
        localStorage.setItem("mw_pro_5000", JSON.stringify(resultats));
    }

    function ajouter() {
        let n = document.getElementById("numero").value;
        if(!n) return;
        resultats.unshift(parseInt(n));
        if(resultats.length > 5000) resultats.pop();
        save();
        updateUI();
    }

    // SIMULATION MASSIVE DE 5000 TOURS
    function simulationFull() {
        const valeurs = [1,2,5,8,10,15,20,30,40];
        resultats = []; // On repart √† z√©ro pour la simulation compl√®te
        for(let i=0; i<5000; i++) {
            let r = valeurs[Math.floor(Math.random() * valeurs.length)];
            resultats.push(r);
        }
        save();
        updateUI();
        alert("Simulation de 5000 r√©sultats termin√©e !");
    }

    function switchTab(h) {
        currentView = h;
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        if(h==24) document.getElementById('t24').classList.add('active');
        if(h==48) document.getElementById('t48').classList.add('active');
        if(h==72) document.getElementById('t72').classList.add('active');
        updateUI();
    }

    function updateUI() {
        const histDiv = document.getElementById("historique");
        const countSpan = document.getElementById("count");
        const emptyMsg = document.getElementById("empty-msg");
        
        countSpan.innerText = resultats.length;

        let aAfficher = [];
        if(currentView === 24) {
            aAfficher = resultats.slice(0, 500); // 500 premiers
        } else if(currentView === 48) {
            aAfficher = resultats.slice(500, 1000); // 500 suivants
        } else {
            aAfficher = resultats.slice(1000, 5000); // Le reste jusqu'√† 5000
        }

        if(aAfficher.length === 0) {
            histDiv.innerHTML = "";
            emptyMsg.style.display = "block";
        } else {
            emptyMsg.style.display = "none";
            histDiv.innerHTML = aAfficher.map(n => `<div class="res-item">${n}</div>`).join('');
        }
    }

    function prediction() {
        if(resultats.length < 10) {
            alert("Besoin de plus de donn√©es pour analyser 5000 tours.");
            return;
        }

        // Fr√©quence sur les 5000
        let freq = {};
        resultats.forEach(n => freq[n] = (freq[n] || 0) + 1);

        let sorted = Object.entries(freq).sort((a,b) => b[1] - a[1]);
        let top = sorted[0][0];
        let retard = sorted[sorted.length - 1][0];

        // Pattern (s√©quence)
        let lastPattern = resultats.slice(0, 3).reverse().join(" > ");

        document.getElementById("prediction-res").innerHTML = `
            <div class="stat-grid">
                <div class="stat-card">Probabilit√©<span class="stat-val">n¬∞ ${top}</span></div>
                <div class="stat-card">En Retard<span class="stat-val">n¬∞ ${retard}</span></div>
            </div>
            <div style="margin-top:10px; text-align:center;">
                <strong>Pattern actuel :</strong> ${lastPattern}<br>
                <small>Calcul√© sur un historique de ${resultats.length} tours</small>
            </div>
        `;
    }

    function resetData() {
        if(confirm("Effacer d√©finitivement les 5000 r√©sultats ?")) {
            resultats = [];
            localStorage.removeItem("mw_pro_5000");
            updateUI();
            document.getElementById("prediction-res").innerHTML = "Donn√©es effac√©es.";
        }
    }

    updateUI();
</script>

</body>
</html>
